<?php
 $key="pW6sWHofMuXKKUcV5MwVn9msKrn1fDqA";//這是hashKEY
 $iv= "CBTOfXVhnyiC5jFP";//這是商店的密碼
 $mid="MS146520879";//這是商店代號
// ch21
$data1="b155b0e358337abd00a398eaba7a5dfdf1b7b16d8624e1f19b217cff711f054
81d5fd2ecb8eeab71eb6e2a67ac917482b5e4c0b95f6b6024f2bc5d781b671518a48b06
1c60f6118b14c73918badf2f932f3f78196b4d1157aa71ba562bfc387ff033525fa167c
5cf04ca80189212f8223ab0a67a091963ee3810c4f470560873696b0d3c0f71a20ed960
5e61446f94593412a2a862fab58992d1027e566c489b450d1086520ff80012f7f036612
db2765d1b8fb01ed253315eb759d6159a2af5e6bdac9a640bd347fb3bd78827daa314fc
293f521ced384aab72b367c56b26ed4e81fd32e04701199c5556dbc1b249da223ce9a91
43ef961736aa9e6024e3f59a9a6742678320fb80f25c163582a13fd7c4a8f81c6653e8f
8429f23984459a6efecaf2c5864adf0ea6498ca9bafcd40f425e0a2c4abc3eaffd5b2d5
db98b987c92521fba6d0e9813027319a50919543d6b2fc6210785e389f351902dc020b5
174acebb50ec7e949570c0a4156f6133c8475a439e11a1baf3065160b18f37f09246db2
4b5da231d349f1d48435e640ed2c3ddf26a348b86645b51ed3e340d8a2a";
// 測試
Status="SUCCESS&MerchantID=MS12345678&Version=2.0&TradeInfo=b155b0e358337abd00a398eaba7a5dfdf1b7b16d8624e1f19b217cff711f05481d5fd2ecb8eeab71eb6e2a67ac917482b5e4c0b95f6b6024f2bc5d781b671518a48b061c60f6118b14c73918badf2f932f3f78196b4d1157aa71ba562bfc387ff033525fa167c5cf04ca80189212f8223ab0a67a091963ee3810c4f470560873696b0d3c0f71a20ed9605e61446f94593412a2a862fab58992d1027e566c489b450d1086520ff80012f7f036612db2765d1b8fb01ed253315eb759d6159a2af5e6bdac9a640bd347fb3bd78827daa314fc293f521ced384aab72b367c56b26ed4e81fd32e04701199c5556dbc1b249da223ce9a9143ef961736aa9e6024e3f59a9a6742678320fb80f25c163582a13fd7c4a8f81c6653e8f8429f23984459a6efecaf2c5864adf0ea6498ca9bafcd40f425e0a2c4abc3eaffd5b2d5db98b987c92521fba6d0e9813027319a50919543d6b2fc6210785e389f351902dc020b5174acebb50ec7e949570c0a4156f6133c8475a439e11a1baf3065160b18f37f09246db24b5da231d349f1d48435e640ed2c3ddf26a348b86645b51ed3e340d8a2a&TradeSha=8CE5D4C5E658E487745506DBF28EFC63C2F57A446E95E91D22DF249F0CD8EA47";
strippadding($string);
//去除 padding 副程式
function strippadding($string) {
 $slast = ord(substr($string, -1));
 $slastc = chr($slast);
 $pcheck = substr($string, -$slast);
 if (preg_match("/$slastc{" . $slast . "}/", $string)) {
 $string = substr($string, 0, strlen($string) - $slast);
 return $string;
 } else {
 return false;} }
 //主程式
 $edata1=strippadding(openssl_decrypt(hex2bin($data1), "AES-256-CBC",
 $key, OPENSSL_RAW_DATA|OPENSSL_ZERO_PADDING, $iv));
 echo "解密後資料=[<font color=darkblue><gg
 id='outtt'>".$edata1."</gg></font>]<br>";
 ?>